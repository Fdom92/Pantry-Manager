@let primary = getPrimaryPlan();

<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/dashboard"></ion-back-button>
    </ion-buttons>
    <ion-title>{{ 'upgrade.title' | translate }}</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <div class="upgrade-hero">
    <div class="pro-badge">PRO</div>
    <h1>{{ 'upgrade.headline' | translate }}</h1>
    <p>{{ 'upgrade.subtitle' | translate }}</p>
    <div class="hero-actions">
      @if (primary) {
        <ion-button color="warning" size="large" (click)="onSelectPlan(primary)">
          {{ primary.ctaLabel }}
        </ion-button>
      }
      <ion-button fill="clear" color="light" (click)="maybeLater()">
        {{ 'upgrade.actions.maybeLater' | translate }}
      </ion-button>
    </div>
  </div>

  <ion-card class="benefits-card">
    <ion-card-header>
      <ion-card-subtitle>{{ 'upgrade.benefits.subtitle' | translate }}</ion-card-subtitle>
      <ion-card-title>{{ 'upgrade.benefits.title' | translate }}</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <ul class="benefits-list">
        @for (key of benefitKeys; track key) {
          <li>
            <ion-icon name="star-outline"></ion-icon>
            <span>{{ key | translate }}</span>
          </li>
        }
      </ul>
    </ion-card-content>
  </ion-card>

  <div class="plans-section">
    <div class="plans-grid">
      @if (plans.length) {
        @for (plan of plans; track plan.id) {
          <app-plan-card
            [title]="plan.title"
            [subtitle]="plan.subtitle"
            [price]="plan.price"
            [period]="plan.period"
            [benefits]="plan.benefits"
            [savings]="plan.savings"
            [trialLabel]="plan.trialLabel"
            [ctaLabel]="plan.ctaLabel"
            [badge]="plan.badge"
            [highlight]="plan.highlight"
            [disabled]="!!purchasingId || loadingPackages"
            (selectPlan)="onSelectPlan(plan)">
          </app-plan-card>
        }
      } @else {
        <ion-note>{{ 'upgrade.plans.unavailable' | translate }}</ion-note>
      }
    </div>
  </div>

  <div class="cta-block">
    <ion-button expand="block" fill="outline" color="secondary" (click)="onRestore()">
      {{ 'upgrade.actions.restore' | translate }}
    </ion-button>
    <ion-note>
      {{ 'upgrade.note' | translate }}
    </ion-note>
    @if (isPro$ | async) {
      <ion-badge color="success">{{ 'upgrade.alreadyPro' | translate }}</ion-badge>
    }
  </div>
</ion-content>
