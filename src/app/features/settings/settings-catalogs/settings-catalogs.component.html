  <ion-header>
    <ion-toolbar>
      <ion-buttons slot="start">
        <ion-back-button defaultHref="/settings"></ion-back-button>
      </ion-buttons>
      <ion-title>{{ 'settings.catalogs.title' | translate }}</ion-title>
    </ion-toolbar>
  </ion-header>

<ion-content>
  @if (loading()) {
    <ion-progress-bar type="indeterminate"></ion-progress-bar>
  }
  <div class="catalogs-content">
    <ion-list lines="full">
      <ion-list-header>
        <ion-label>
          <h2>{{ 'settings.catalogs.locations.title' | translate }}</h2>
          <p>{{ 'settings.catalogs.locations.subtitle' | translate }}</p>
        </ion-label>
      </ion-list-header>

      @if (!locationOptionsDraft().length) {
        <ion-item lines="none">
          <ion-text color="medium">
            {{ 'settings.catalogs.locations.empty' | translate }}
          </ion-text>
        </ion-item>
      }

      @for (location of locationOptionsDraft(); track $index; let i = $index) {
        <ion-item>
          <ion-input
            label="{{ 'settings.catalogs.locations.field' | translate:{ index: i + 1 } }}"
            labelPlacement="stacked"
            [value]="location"
            (ionInput)="onLocationOptionInput(i, $event)"
            autocomplete="off"
            autocorrect="off">
          </ion-input>
          <ion-button
            slot="end"
            fill="clear"
            color="danger"
            (click)="removeLocationOption(i)">
            <ion-icon slot="icon-only" name="trash-outline"></ion-icon>
          </ion-button>
        </ion-item>
      }

      <ion-item class="options-footer" lines="none">
        <ion-button
          fill="clear"
          size="small"
          (click)="addLocationOption()">
          <ion-icon slot="start" name="add-circle-outline"></ion-icon>
          {{ 'settings.catalogs.locations.add' | translate }}
        </ion-button>
        <ion-button
          fill="clear"
          size="small"
          color="medium"
          (click)="restoreDefaultLocationOptions()">
          <ion-icon slot="start" name="refresh-outline"></ion-icon>
          {{ 'settings.catalogs.restoreDefaults' | translate }}
        </ion-button>
      </ion-item>
    </ion-list>

    <ion-list lines="full">
      <ion-list-header>
        <ion-label>
          <h2>{{ 'settings.catalogs.categories.title' | translate }}</h2>
          <p>{{ 'settings.catalogs.categories.subtitle' | translate }}</p>
        </ion-label>
      </ion-list-header>

      @if (!categoryOptionsDraft().length) {
        <ion-item lines="none">
          <ion-text color="medium">
            {{ 'settings.catalogs.categories.empty' | translate }}
          </ion-text>
        </ion-item>
      }

      @for (category of categoryOptionsDraft(); track $index; let i = $index) {
        <ion-item>
          <ion-input
            label="{{ 'settings.catalogs.categories.field' | translate:{ index: i + 1 } }}"
            labelPlacement="stacked"
            [value]="category"
            (ionInput)="onCategoryOptionInput(i, $event)"
            autocomplete="off"
            autocorrect="off">
          </ion-input>
          <ion-button
            slot="end"
            fill="clear"
            color="danger"
            (click)="removeCategoryOption(i)">
            <ion-icon slot="icon-only" name="trash-outline"></ion-icon>
          </ion-button>
        </ion-item>
      }

      <ion-item class="options-footer" lines="none">
        <ion-button
          fill="clear"
          size="small"
          (click)="addCategoryOption()">
          <ion-icon slot="start" name="add-circle-outline"></ion-icon>
          {{ 'settings.catalogs.categories.add' | translate }}
        </ion-button>
        <ion-button
          fill="clear"
          size="small"
          color="medium"
          (click)="restoreDefaultCategoryOptions()">
          <ion-icon slot="start" name="refresh-outline"></ion-icon>
          {{ 'settings.catalogs.restoreDefaults' | translate }}
        </ion-button>
      </ion-item>
    </ion-list>

    <ion-list lines="full">
      <ion-list-header>
        <ion-label>
          <h2>{{ 'settings.catalogs.supermarkets.title' | translate }}</h2>
          <p>{{ 'settings.catalogs.supermarkets.subtitle' | translate }}</p>
        </ion-label>
      </ion-list-header>

      @if (!supermarketOptionsDraft().length) {
        <ion-item lines="none">
          <ion-text color="medium">
            {{ 'settings.catalogs.supermarkets.empty' | translate }}
          </ion-text>
        </ion-item>
      }

      @for (supermarket of supermarketOptionsDraft(); track $index; let i = $index) {
        <ion-item>
          <ion-input
            label="{{ 'settings.catalogs.supermarkets.field' | translate:{ index: i + 1 } }}"
            labelPlacement="stacked"
            [value]="supermarket"
            (ionInput)="onSupermarketOptionInput(i, $event)"
            autocomplete="off"
            autocorrect="off">
          </ion-input>
          <ion-button
            slot="end"
            fill="clear"
            color="danger"
            (click)="removeSupermarketOption(i)">
            <ion-icon slot="icon-only" name="trash-outline"></ion-icon>
          </ion-button>
        </ion-item>
      }

      <ion-item class="options-footer" lines="none">
        <ion-button
          fill="clear"
          size="small"
          (click)="addSupermarketOption()">
          <ion-icon slot="start" name="add-circle-outline"></ion-icon>
          {{ 'settings.catalogs.supermarkets.add' | translate }}
        </ion-button>
        <ion-button
          fill="clear"
          size="small"
          color="medium"
          (click)="restoreDefaultSupermarketOptions()">
          <ion-icon slot="start" name="refresh-outline"></ion-icon>
          {{ 'settings.catalogs.restoreDefaults' | translate }}
        </ion-button>
      </ion-item>
    </ion-list>

    <div class="catalog-actions">
      <ion-button
        expand="block"
        (click)="saveCatalogs()"
        [disabled]="!hasAnyChanges() || savingCatalogs()">
        @if (savingCatalogs()) {
          <ion-spinner
            slot="start"
            name="dots">
          </ion-spinner>
        }
        {{ 'settings.catalogs.saveAction' | translate }}
      </ion-button>
    </div>
  </div>
</ion-content>
